<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Details</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: white;
            position: relative;
        }

        /* Header */
        .header {
            position: absolute;
            top: 25px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }

        .header button {
            background: white;
            border: none;
            border-radius: 50px;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            width: 40px;
            height: 40px;
        }

        .header img {
            width: 23px;
            height: 23px;
        }

        .header-buttons {
            display: flex;
            gap: 10px;
            margin-right: 15px;
        }

        /* Image Slider */
        .image-slider {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            white-space: nowrap;
            scrollbar-width: none;
            -ms-overflow-style: none;
            scroll-behavior: smooth; /* âœ… Smooth transition */
            transition: scroll-left 0.3s ease-in-out; /* Optional */
        }

        .image-slider::-webkit-scrollbar {
            display: none;
        }

        .image-slider img {
            min-width: 100%; /* Ensures full width */
            height: auto;
            object-fit: cover;
            scroll-snap-align: start;
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
            transition: transform 0.3s ease-in-out; /* Optional zoom-like effect */
        }

        /* Property Info */
        .property-info {
            padding: 10px 20px;
        }

        /* EMI Box */
        .emi-box {
            width: 85%;
            border: 1px solid lightgray;
            padding: 10px;
            margin-top: 20px;
            font-size: 13px;
            color: gray;
            text-align: left;
            position: relative;
            height: 45px;
        }

        .emi-box p{
            margin-top: 0px;
        }

        .emi-box hr {
            width: 100%;
            border: 0.5px solid lightgray;
            margin-top: -5px;
        }

        .emi-box img {
            width: 75px;
            position: absolute;
            right: 10px;
            
        }

        /* Auction Section */
        .auction-container {
            width: 90%;
            margin: 20px auto;
            text-align: center;
        }

        .auction-inputs {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid lightgray;
            padding: 10px;
            border-radius: 5px;
        }

        .auction-input {
            width: 60%;
            padding: 8px;
            font-size: 14px;
            border: 1px solid lightgray;
            border-radius: 5px;
        }

        .auction-submit {
            background-color: #1a1a1a;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.5); /* Right corner shadow */
        }

        .auction-box {
            border: 1px solid lightgray;
            padding: 10px;
            border-radius: 5px;
            margin-top: 15px;
            text-align: left;
            font-size: 14px;
            color: gray;
            background-color: #f9f9f9;
            max-height: 200px;
            overflow-y: auto;
        }

        .auction-item {
            border-bottom: 1px solid lightgray;
            padding: 8px 0;
        }


        .buy-button {
            width: 90%;
            height: 40px;
            background-color: #2e6aff;
            color: white;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.5); /* Right corner shadow */
        }

        .compare-deals {
            width: 90%;
            margin: 20px auto;
            text-align: center;
        }

        .platform-box {
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid lightgray;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .platform-logo {
            width: 30px;
            height: 30px;
        }

        .platform-name {
            flex-grow: 1;
            text-align: left;
            margin-left: 10px;
            font-size: 15px;
            color: grey;
        }

        .buy-now-btn {
            background-color: #1a1a1aff;
            color: white;
            border: none;
            padding: 13px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 3px 3px 10px rgba(20, 20, 20, 0.5); /* Right corner shadow */
        }

        .card-icon {
            width: 16px;
            height: 16px;
        }

        .vs-text {
            font-size: 13px;
            font-weight: bold;
            color: grey;
            margin: 10px 0;
        }

        .faq-container {
            width: 90%;
            margin: 20px auto;
        }

        .faq-item {
            border-bottom: 1px solid lightgray;
            padding: 10px 0;
        }

        .faq-question {
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: color 0.3s ease-in-out;
        }

        .faq-question.active-question {
            color: #3397E8;
        }

        .faq-icon {
            width: 16px;
            height: 16px;
        }

        .faq-answer {
            display: none;
            padding: 5px 0;
            font-size: 14px;
            color: rgb(63, 63, 63);
        }

        .faq-answer ul {
            padding-left: 20px;
        }

        .faq-answer li {
            margin-bottom: 5px;
        }

        .recommended-products-container {
            width: 90%;
            margin: 20px auto;
        }
        .recommended-products {
            display: flex;
            overflow-x: auto;
            white-space: nowrap;
            gap: 10px;
            padding: 10px 0;
            scrollbar-width: none;
        }
        .recommended-products::-webkit-scrollbar {
            display: none;
        }
        .product {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 150px;
            height: 215px;
            background: white;
            padding: 10px;
            border-radius: 10px;
            /* box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1); */
        }
        .product img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 5px;
        }
        .product-name {
            font-size: 16px;
            color: #1f1f1f;
            margin-top: 10px;
        }
        .product-price {
            font-size: 15px;
            color: #333;
            margin-top: -10px;
        }


        #equalizer-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
        }

        #equalizer-loader .bar {
            width: 5px;
            height: 30px;
            background-color: black;
            animation: equalizer 1s infinite ease-in-out;
        }

        #equalizer-loader .bar:nth-child(1) {
            animation-delay: -0.4s;
        }
        #equalizer-loader .bar:nth-child(2) {
            animation-delay: -0.3s;
        }
        #equalizer-loader .bar:nth-child(3) {
            animation-delay: -0.2s;
        }
        #equalizer-loader .bar:nth-child(4) {
            animation-delay: -0.1s;
        }
        #equalizer-loader .bar:nth-child(5) {
            animation-delay: 0s;
        }

        @keyframes equalizer {
            0%, 100% {
                transform: scaleY(1);
            }
            50% {
                transform: scaleY(2.5);
            }
        }

    </style>
</head>
<body>
    
    <div id="equalizer-loader">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
    </div>
    <script>
        window.addEventListener('load', function () {
            const loader = document.getElementById('equalizer-loader');
            if (loader) {
                loader.style.display = 'none';
            }
        });
    </script>
    
    <!-- Header -->
    <div class="header">
        <button style="margin-left: 15px; -webkit-tap-highlight-color: transparent;" onclick="history.back()">
            <img src="{{ url_for('static', filename='images/leftarrow.png') }}" alt="Back">
        </button>
        <div class="header-buttons">
            <button style="-webkit-tap-highlight-color: transparent;">
                <img src="{{ url_for('static', filename='images/share.svg') }}" alt="Share">
            </button>
            <button id="fav-button" onclick="addToFav('{{ product_id }}')" style="-webkit-tap-highlight-color: transparent;">
                <img id="fav-icon" src="{{ url_for('static', filename='images/watchlist-added.svg') if in_watchlist else url_for('static', filename='images/watchlist.svg') }}" alt="Favorite">
            </button>
        </div>
    </div>

    <!-- Image Slider -->
    <div class="image-slider">
        {% for image in images %}
            <img src="{{ url_for('static', filename='images/product_images/' + product_id + '/' + image) }}" loading="lazy" alt="{{ name }}">
        {% endfor %}
    </div>

    <!-- Property Info -->
    <div class="property-info">
        <p style="font-size: 18px; font-weight: 600; color: rgb(63, 63, 63);">{{ name }}</p>
        <p style="margin-top: -6px; font-size: 15px; color: gray;">{{ description }}</p>
    </div>

    <center>
        <form action="{{ url_for('buynow') }}" method="POST">
            <input type="hidden" name="product_id" value="{{ product_id }}">
            <input type="hidden" name="username" value="{{ username }}">
            <button class="buy-button" style="-webkit-tap-highlight-color: transparent;">BUY NOW</button>
        </form>
    </center>

    <center>
        <div class="emi-box">
            <p>EMIs starting at best price on 12 months period</p>
            <hr>
            <img src="{{ url_for('static', filename='images/razorpay.svg') }}" alt="Razorpay">
        </div>
    </center>


    <div class="auction-container">
        <div class="auction-inputs">
            <input type="text" id="bidAmount" class="auction-input" placeholder="Enter bid amount (â‚¹)">
            <button onclick="submitBid()" class="auction-submit" style="-webkit-tap-highlight-color: transparent;">Bid Now</button>
        </div>
    
        <div class="auction-box" id="auctionList">
            {% if fetch_bids %}
            <table style="width:100%; font-size: 13px; color: #333; border-collapse: collapse;">
                <thead>
                    <tr style="background-color: #f0f0f0;">
                        <th style="text-align: left; padding: 6px;">Name</th>
                        <th style="text-align: left; padding: 6px;">Price</th>
                        <th style="text-align: left; padding: 6px;">Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for bid in fetch_bids %}
                    <tr>
                        <td style="padding: 6px;">{{ bid.name }}</td>
                        <td style="padding: 6px;">â‚¹{{ bid.price }}</td>
                        <td style="padding: 6px;">{{ bid.datetime.split(" ")[0] if bid.datetime else '' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
                <p style="color: gray; font-size: 12px;">No bids placed yet.</p>
            {% endif %}
        </div>
        
    </div>


    <!-- <p style="margin-top: 10px; font-size: 10px; color: gray; text-align: center;">COMPARE THE PRICE</p> -->



    <div class="compare-deals">

        <!-- Own Platform -->
        <div class="platform-box" style="background-color: #f8f8f8;">
            <img src="{{ url_for('static', filename='images/logo2.svg') }}" alt="Our Platform" class="platform-logo">
            <span class="platform-name">Add to cart</span>
            <form action="{{ url_for('add_to_cart') }}" method="POST">
                <input type="hidden" name="product_id" value="{{ product_id }}">
                <button type="submit" class="buy-now-btn" style="-webkit-tap-highlight-color: transparent;">
                    {{ price }}&nbsp;
                    <img src="{{ url_for('static', filename='images/cart-light.svg') }}" alt="Cart" class="card-icon">
                </button>
            </form>
        </div>
    
        <!-- VS Text -->
        <div class="vs-text">VS</div>
    
        <!-- Competitor Platform 1 -->
        <div class="platform-box" style="-webkit-tap-highlight-color: transparent;">
            <!-- <img src="{{ url_for('static', filename='images/logo2.svg') }}" alt="Amazon" class="platform-logo"> -->
            {% for c in competitors %}
                <span class="platform-name">{{ c.name }}</span>        
                <span style="font-size: 15px;">â‚¹ {{ c.price }}</span>
            {% endfor %}
            <!-- <button class="buy-now-btn">
                â‚¹ 10,80,000
            </button> -->
        </div>
    
        <!-- Competitor Platform 2
        <div class="platform-box">
            <img src="{{ url_for('static', filename='images/logo2.svg') }}" alt="Flipkart" class="platform-logo">
            <span class="platform-name">Flipkart</span>
            <button class="buy-now-btn">
                â‚¹ 10,60,000
            </button>
        </div>
    
        Competitor Platform 3
        <div class="platform-box">
            <img src="{{ url_for('static', filename='images/logo2.svg') }}" alt="Snapdeal" class="platform-logo">
            <span class="platform-name">Snapdeal</span>
            <button class="buy-now-btn">
                â‚¹ 10,75,000
            </button>
        </div> -->
    
    </div>


    <div class="faq-container">
    
        <div class="faq-item">
            <button class="faq-question" onclick="toggleFAQ(0)" style="-webkit-tap-highlight-color: transparent;">
                <img src="{{ url_for('static', filename='images/barcode.png') }}" alt="Q" class="faq-icon">
                Authenticated
            </button>
            <div class="faq-answer">
                <ul>
                    <li>Our legit check system is fash & effective to ensure each product is 100% authentic, along with legit check reports & proof of purchase and quality check.</li>
                    <li>authenticity is the foundation of our business, and every item we sell is inspected by our expert team. Our authenticators are the most experienced and highly trained in the business.</li>
                    <li>In addition, we source our products only from trusted suppliers.</li>
                </ul>
            </div>
        </div>
    
        <div class="faq-item">
            <button class="faq-question" onclick="toggleFAQ(1)" style="-webkit-tap-highlight-color: transparent;">
                <img src="{{ url_for('static', filename='images/verified.png') }}" alt="Q" class="faq-icon">
                Our Promise
            </button>
            <div class="faq-answer">
                <ul>
                    <li>We strive to keep your trust with mechanisms to ensure only legitimate items across all catrgories on our marketplace. Rest assured, If there is a concern with any of the items, we'll make it right.</li>
                    <li>You do not have to deal with any suppliers. We manage all the sourcing with guaranteed shipping and authentication.</li>
                    <li>Our team of experts uses a regorous, multi-step verification process involving machine learning, embedded technologies and a manual quality assurance finally.</li>
                </ul>
            </div>
        </div>
    
        <div class="faq-item">
            <button class="faq-question" onclick="toggleFAQ(2)" style="-webkit-tap-highlight-color: transparent;">
                <img src="{{ url_for('static', filename='images/box.png') }}" alt="Q" class="faq-icon">
                Shipping & EMIs
            </button>
            <div class="faq-answer">
                <ul>
                    <li>Orders are typically shipped within 7-12 days, understanding a thorough verification process, with our dedicated team ensuring timely delivery; however, certain ETA pairs mayt take 21-25 days for shipping.</li>
                    <li>You can also enjoy the covenience of No-Cost EMIs on our website and app, Allowing you to pay in installments.</li>
                </ul>
            </div>
        </div>
    </div>


    <!-- <div class="recommended-products-container">
        <p style="text-align: left;">Recommended Products</p>
        <div class="recommended-products">
            <div class="product">
                <img src="{{ url_for('static', filename='images/product.jpg') }}" alt="Product 1">
                <p class="product-name">Product 1</p>
                <p class="product-price">â‚¹1,200</p>
            </div>
            <div class="product">
                <img src="{{ url_for('static', filename='images/product.jpg') }}" alt="Product 2">
                <p class="product-name">Product 2</p>
                <p class="product-price">â‚¹2,500</p>
            </div>
            <div class="product">
                <img src="{{ url_for('static', filename='images/product.jpg') }}" alt="Product 3">
                <p class="product-name">Product 3</p>
                <p class="product-price">â‚¹3,000</p>
            </div>
            <div class="product">
                <img src="{{ url_for('static', filename='images/product.jpg') }}" alt="Product 4">
                <p class="product-name">Product 4</p>
                <p class="product-price">â‚¹4,800</p>
            </div>
        </div>
    </div> -->


</body>
</html>


<script>
    function addToFav(productId) {
        fetch(`/addtofav/${productId}`, {
            method: 'GET'
        })
        .then(response => {
            if (response.ok) {
                console.log(`Product ${productId} added to favorites`);
                // Optionally update the icon to show itâ€™s added
                document.getElementById('fav-icon').src = "{{ url_for('static', filename='images/watchlist-added.svg') }}";
                window.location.href = '/dashboard';
            } else {
                console.error('Failed to add to favorites');
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }


    function toggleFAQ(index) {
        let answers = document.querySelectorAll('.faq-answer');
        let questions = document.querySelectorAll('.faq-question');

        // Toggle answer visibility
        let isVisible = answers[index].style.display === 'block';
        answers[index].style.display = isVisible ? 'none' : 'block';

        // Remove active color from all questions
        questions.forEach(q => q.classList.remove('active-question'));

        // Add active color only if the answer is opened
        if (!isVisible) {
            questions[index].classList.add('active-question');
        }
    }



    function submitBid() {
        const bidAmount = document.getElementById('bidAmount').value;
        const productId = "{{ product_id }}";

        if (!bidAmount || isNaN(bidAmount) || bidAmount <= 0) {
            alert("Please enter a valid bid amount.");
            return;
        }

        fetch("{{ url_for('place_bid') }}", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": "{{ csrf_token() if csrf_token else '' }}"  // Optional: only if CSRF protection is enabled
            },
            body: JSON.stringify({
                product_id: productId,
                bid_amount: bidAmount
            })
        })
        .then(response => response.json())
        .then(data => {
            console.log(data);
            // alert(data.message || "Bid placed successfully!");

            location.reload();


            // Optionally update auction box
            // document.getElementById('auctionList').innerHTML = ...
        })
        .catch(error => {
            console.error("Error:", error);
            alert("An error occurred while placing the bid.");
        });
    }
</script>